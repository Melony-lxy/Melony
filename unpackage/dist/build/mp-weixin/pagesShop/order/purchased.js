require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesShop/order/purchased"],{"123c":function(t,i,e){"use strict";(function(t,i){var n=e("47a9");e("6103");n(e("3240"));var o=n(e("50909"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(o.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},"34bd":function(t,i,e){"use strict";e.r(i);var n=e("467e"),o=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=o.a},"35d0":function(t,i,e){"use strict";var n=e("7e49"),o=e.n(n);o.a},"467e":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("d9a0"),o=(e("8f59"),{components:{},data:function(){return{commodityList:[],totalCount:0,page:1,limit:10,query:{},purchasedList:[],commodityInfo:{},addPurchasedList:[],checkedList:[],purchasedSource:{type:"detail"},isPc:!0}},onShow:function(){this.addPurchasedList=this.$store.state.addPurchasedList,this.purchasedSource=this.$store.state.purchasedSource,this.list()},methods:{number:function(t){if(this.addPurchasedList.length){var i=this.addPurchasedList.filter((function(i){return i.product_id===t.id}));return console.log(i,"list"),i.length?"x "+i[0].number:""}return""},priceChange:function(t){console.log(t,this.addPurchasedList,"data");var i=this.addPurchasedList.some((function(i){return i.product_id===t.id}));if(this.addPurchasedList.length&&i){var e=this.addPurchasedList.filter((function(i){return i.product_id===t.id}));return e.length?e[0].specificationsStatus.price:""}return t.price===t.original_price?"￥"+t.price:"￥"+t.price+"~"+t.original_price},specificationsStatus:function(t){if(this.checkedList.indexOf(t.id)>-1){if(this.addPurchasedList.length){var i=this.addPurchasedList.filter((function(i){return i.product_id===t.id}));return i.length?i[0].specificationsStatus.name.map((function(t){return t.name})).join("/"):"请选择规格"}return"请选择规格"}return""},skip:function(i){t.navigateTo({url:"/pagesShop/commodity/detail?id="+i+"&purchased=true"})},onreachBottom:function(){if(this.commodityList.length<this.totalCount)return this.page=this.page+1,void this.list();t.showToast({icon:"none",title:"到底了"})},showCategory:function(t){this.isShowCategory=!0},list:function(){var i=this;t.showLoading({title:"加载中"}),(0,n.additionalPurchaseList)({page:this.page,limit:this.limit,query:"order"===this.purchasedSource.type?{oid:this.purchasedSource.oid,productId:this.commodityList.length?this.commodityList[this.commodityList.length-1].id:0}:{productId:this.commodityList.length?this.commodityList[this.commodityList.length-1].id:0}}).then((function(e){if(0==e.code){e.data.data.map((function(t){return t.status=!1,t}));i.commodityList=i.commodityList.concat(e.data.data),i.totalCount=e.data.totalCount,i.addPurchasedList.length&&(i.checkedList=i.addPurchasedList.map((function(t){return t.product_id})),i.checkedList.forEach((function(t){i.commodityList.map((function(i){return t===i.id&&(i.status=!0),i}))}))),t.hideLoading()}})).catch((function(){t.hideLoading()}))},pitchOn:function(t,i){var e={};if(e=1==t.detail.value.length?{value:!0,name:this.commodityList[i].id}:{value:!1,name:this.commodityList[i].id},!e.value&&this.checkedList.indexOf(e.name)>-1){var n=this.addPurchasedList.filter((function(t){return t.product_id!==e.name}));this.addPurchasedList=n,this.$store.commit("addPurchasedList",n),this.checkedList=this.checkedList.filter((function(t){return t!==e.name}))}else this.checkedList.push(e.name)},addPurchased:function(){var i=this,e=this.checkedList.every((function(t){return i.addPurchasedList.some((function(i){return t===i.product_id}))}));e?"order"===this.purchasedSource.type?t.redirectTo({url:"/pagesShop/order/index"}):"detail"===this.purchasedSource.type?(this.addPurchasedList.forEach((function(t){var i=t.specificationsStatus.name.map((function(t){return t.name})),e={product_id:t.product_id,number:t.number,specifications:i,gift:[],type:2};(0,n.addCart)(e).then((function(t){0==t.code?console.log(111):console.log(222)}))})),this.$store.commit("addPurchasedList",[]),t.showToast({icon:"none",title:"添加成功",duration:2e3}),t.navigateBack()):t.switchTab({url:"/pages/shop/index"}):t.showToast({icon:"none",title:"请选择商品规格"})}}});i.default=o}).call(this,e("df3c")["default"])},50909:function(t,i,e){"use strict";e.r(i);var n=e("d466"),o=e("34bd");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(a);e("35d0"),e("912a");var c=e("828b"),s=Object(c["a"])(o["default"],n["b"],n["c"],!1,null,"08140277",null,!1,n["a"],void 0);i["default"]=s.exports},"7e49":function(t,i,e){},"912a":function(t,i,e){"use strict";var n=e("aedd"),o=e.n(n);o.a},aedd:function(t,i,e){},d466:function(t,i,e){"use strict";e.d(i,"b",(function(){return o})),e.d(i,"c",(function(){return a})),e.d(i,"a",(function(){return n}));var n={uImage:function(){return e.e("uview-ui/components/u-image/u-image").then(e.bind(null,"31fd"))}},o=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.commodityList,(function(i,e){var n=t.__get_orig(i),o=t.common.imgUrl(i.img),a=t.specificationsStatus(i),c=t.number(i),s=t.priceChange(i);return{$orig:n,g0:o,m0:a,m1:c,m2:s}})));t.$mp.data=Object.assign({},{$root:{l0:e}})},a=[]}},[["123c","common/runtime","common/vendor"]]]);