require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesShop/shopping/index"],{"1c96":function(t,i,n){"use strict";n.d(i,"b",(function(){return o})),n.d(i,"c",(function(){return c})),n.d(i,"a",(function(){return e}));var e={uCheckbox:function(){return n.e("uview-ui/components/u-checkbox/u-checkbox").then(n.bind(null,"dc8f"))},uNumberBox:function(){return n.e("uview-ui/components/u-number-box/u-number-box").then(n.bind(null,"dcb0"))},uImage:function(){return n.e("uview-ui/components/u-image/u-image").then(n.bind(null,"31fd"))},uEmpty:function(){return n.e("uview-ui/components/u-empty/u-empty").then(n.bind(null,"87a0"))},uModal:function(){return n.e("uview-ui/components/u-modal/u-modal").then(n.bind(null,"31b2"))}},o=function(){var t=this,i=t.$createElement,n=(t._self._c,t.commodityInfo.length),e=t.commodityInfo.length,o=0!==e?t.__map(t.commodityInfo,(function(i,n){var e=t.__get_orig(i),o=t.__map(i.list,(function(i,n){var e=t.__get_orig(i),o=t.isDisabled(i),c=t.common.imgUrl(i.product.img),s=t.specificationsStatus(i),u=t.isDisabled(i),a=i.gift.length,r=a?t.__map(i.gift,(function(i,n){var e=t.__get_orig(i),o=t.common.imgUrl(i.img),c=i.specifications.join("/"),s=t.giftIsDisabled(i);return{$orig:e,g4:o,g5:c,m3:s}})):null;return{$orig:e,m0:o,g2:c,m1:s,m2:u,g3:a,l0:r}}));return{$orig:e,l1:o}})):null,c=t.checkedId.length;t._isMounted||(t.e0=function(i,n){var e=arguments[arguments.length-1].currentTarget.dataset,o=e.eventParams||e["event-params"];n=o.item;t.currId=n.id},t.e1=function(){t.show=!1}),t.$mp.data=Object.assign({},{$root:{g0:n,g1:e,l2:o,g6:c}})},c=[]},"1ca1":function(t,i,n){"use strict";var e=n("ba59"),o=n.n(e);o.a},5654:function(t,i,n){"use strict";n.r(i);var e=n("926f"),o=n.n(e);for(var c in e)["default"].indexOf(c)<0&&function(t){n.d(i,t,(function(){return e[t]}))}(c);i["default"]=o.a},"926f":function(t,i,n){"use strict";(function(t){var e=n("47a9");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=e(n("7ca3")),c=n("d9a0"),s=n("8f59");function u(t,i){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,e)}return n}var a={components:{},data:function(){return{show:!1,mode:"normal",totalPrice:"0.00",isChenkAll:!1,commodityInfo:[],currId:0,checkedId:[],isPc:!0,height:0}},computed:function(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?u(Object(n),!0).forEach((function(i){(0,o.default)(t,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))}))}return t}({},(0,s.mapState)({number:function(t){return t.number},price:function(t){return t.price}})),onShow:function(){var i=this,n="",e="",o="";t.getSystemInfo({success:function(t){n=t.windowHeight}}),setTimeout((function(){t.createSelectorQuery().in(i).select(".fixedTop").boundingClientRect((function(t){e=t.height})).exec(),t.createSelectorQuery().in(i).select(".footer").boundingClientRect((function(t){o=t.height})).exec(),i.height=n+e+o}),1),this.$store.commit("filterCoupon",{}),this.$store.commit("postageCoupon",{}),this.$store.commit("addPurchasedList",[]),this.$store.commit("discountCoupon",{}),this.getList()},onHide:function(){this.mode="normal"},methods:{imgerror:function(t,i,n){"top"==i&&(this.commodityInfo[t].product.img="/static/images/default.png"),"gift"==i&&(this.commodityInfo[t].gift[n].img="/static/images/default.png")},skip:function(i){t.navigateTo({url:"/pagesShop/commodity/detail?id="+i})},changestore:function(t){for(var i=this,n=0;n<this.commodityInfo.length;n++)if(this.commodityInfo[n].id==t.name)for(var e=0;e<this.commodityInfo[n].list.length;e++)(0,c.changeCart)({id:this.commodityInfo[n].list[e].id,status:t.value}).then((function(){i.getList()}))},isEdit:function(){"normal"===this.mode?this.mode="edit":this.mode="normal"},isDisabled:function(t){return!("0"!==t.product.status||!t.specificationsStatus.stock)},giftIsDisabled:function(t){return!("0"!==t.status||!t.stock)},specificationsStatus:function(t){return t.specificationsStatus.name.map((function(t){return t.name})).join("/")},changeTotalPrice:function(){var t=0;this.commodityInfo.forEach((function(i){i.list.forEach((function(i){!0===i.status&&(t+=i.number*i.specificationsStatus.price)}))})),this.totalPrice=t.toFixed(2)},getList:function(){var i=this;(0,c.getCartList)().then((function(n){n.data.length?t.setTabBarBadge({index:2,text:n.number}):t.removeTabBarBadge({index:2}),i.commodityInfo=n.data.map((function(t){return t.list=t.list.map((function(t){return 1===t.status&&"0"===t.product.status?t.status=!0:t.status=!1,t})),t.isChenkAll=t.list.every((function(t){return!0===t.status})),t})),i.ifcheckall(),i.changeTotalPrice(),i.changeCheckedId(),t.hideLoading()}))},changeCheckedId:function(){var t=[];this.commodityInfo.filter((function(i){i.list.filter((function(i){!0===i.status&&t.push(i.id)}))})),this.checkedId=t},paymentOrDeletion1:function(){this.show=!0},paymentOrDeletion:function(){var i=this;if(this.checkedId.length)if("normal"===this.mode){var n=[],e=[];if(0===this.commodityInfo.length)return void t.showToast({icon:"none",title:"请选择商品进行结算"});console.log(this.commodityInfo,"123123"),this.commodityInfo.forEach((function(t){t.list.filter((function(i){!0===i.status&&(i.type?e.push({gift:i.gift,product_id:i.product.id,id:i.id,number:i.number,product:{activityList:i.product.activityList,img:i.product.img,name:i.product.name,min_count:i.product.min_count,postage:i.product.postage},specificationsStatus:{img:i.specificationsStatus.img,name:i.specificationsStatus.name,price:i.specificationsStatus.price}}):n.push({org:{oid:t.id,name:t.name},isAdditionalPurchase:t.isAdditionalPurchase,gift:i.gift,id:i.id,number:i.number,product:i.product,specificationsStatus:i.specificationsStatus,status:i.status}))}))})),this.$store.commit("purchaseInfo",n),this.$store.commit("addPurchasedList",e),this.$store.commit("isSeparate",!1),t.navigateTo({url:"/pagesShop/order/index"})}else t.showModal({title:"确认将个"+this.checkedId.length+"宝贝删除？",cancelText:"我再想想",success:function(n){n.confirm?(t.showLoading({title:"加载中"}),(0,c.deleteCart)({id:i.checkedId}).then((function(t){i.getList()})),console.log("用户点击确定")):n.cancel&&console.log("用户点击取消")}});else t.showToast({icon:"none",title:"请选择商品进行结算"})},checkAll:function(i){var n=this;if(0!=this.commodityInfo.length){t.showLoading({title:"加载中"});for(var e=0;e<this.commodityInfo.length;e++)for(var o=0;o<this.commodityInfo[e].list.length;o++)this.commodityInfo[e].list[o].status!=i.value&&(this.commodityInfo[e].list[o].status=!i.value,(0,c.changeCart)({id:this.commodityInfo[e].list[o].id,status:i.value?1:0}).then((function(){n.getList()})))}},ifcheckall:function(){this.commodityInfo=this.commodityInfo.map((function(t){return t.isChenkAll=t.list.every((function(t){return!0===t.status})),t})),0==this.commodityInfo.length?this.isChenkAll=!1:this.isChenkAll=this.commodityInfo.every((function(t){return 1==t.isChenkAll}))},giftNumberChange:function(t,i,n){this.commodityInfo[i].gift[n].number=t.value,(0,c.changeCart)({id:t.index,number:t.value})},numberChange:function(t){this.commodityInfo.forEach((function(i){i.list.map((function(i){i.id==t.index&&(i.number=t.value)}))})),(0,c.changeCart)({id:t.index,number:t.value}),this.changeTotalPrice()},pitchOn:function(t){(0,c.changeCart)({id:t.name,status:t.value?1:0}),this.commodityInfo.map((function(i){i.list.map((function(i){i.id==t.name&&(i.status=!!t.value)}))})),this.ifcheckall(),this.changeTotalPrice(),this.changeCheckedId()}}};i.default=a}).call(this,n("df3c")["default"])},a2ae:function(t,i,n){"use strict";n.r(i);var e=n("1c96"),o=n("5654");for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(i,t,(function(){return o[t]}))}(c);n("f38f"),n("1ca1");var s=n("828b"),u=Object(s["a"])(o["default"],e["b"],e["c"],!1,null,"20074caa",null,!1,e["a"],void 0);i["default"]=u.exports},ba59:function(t,i,n){},bc1e:function(t,i,n){},cf8f:function(t,i,n){"use strict";(function(t,i){var e=n("47a9");n("6103");e(n("3240"));var o=e(n("a2ae"));t.__webpack_require_UNI_MP_PLUGIN__=n,i(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},f38f:function(t,i,n){"use strict";var e=n("bc1e"),o=n.n(e);o.a}},[["cf8f","common/runtime","common/vendor"]]]);