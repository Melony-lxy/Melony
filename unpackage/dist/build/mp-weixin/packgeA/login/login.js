require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packgeA/login/login"],{"5a5e":function(e,t,o){},"617c":function(e,t,o){"use strict";var n=o("5a5e"),i=o.n(n);i.a},"6f59":function(e,t,o){"use strict";(function(e){var n=o("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(o("7ca3")),a=o("babc"),s=o("bd40");function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function c(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){(0,i.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var u={data:function(){return{show:!1,isios:!1,form:{userName:"",password:""},phoneForm:{phone:"",code:""},weixin:!1,seconds:60,isAgreement:!1,isCode:!1,buttons:!1,tips:"",loginType:"",dealer:"",uname:"",uid:"",coupon:"",decrypt:"",store_id:0,commodityId:0,order_id:0,activity_id:0,code:""}},onLoad:function(t){var o=this;if(void 0!=t.order_id&&(this.order_id=t.order_id),void 0!=t.scene){var n=this.getRemainingString(t.scene,"order_");n?this.order_id=n:this.activity_id=t.scene}else void 0!=t.activity_id&&(this.activity_id=t.activity_id);if(void 0!=t.store_id&&(this.store_id=t.store_id),void 0!=t.commodityId&&(this.commodityId=t.commodityId),void 0!=t.id&&this.$store.commit("changeusername",t.id),void 0!=t.type&&this.$store.commit("changetype",t.type),void 0!=t.page&&this.$store.commit("changepage",t.page),void 0!=t.ucode&&this.$store.commit("changecode",t.ucode),void 0!=t.coupon&&void 0!=t.decrypt&&(this.coupon=t.coupon,this.decrypt=t.decrypt,this.$store.commit("changeCoupon",{coupon:t.coupon,decrypt:t.decrypt})),void 0!=t.dealer){this.$axios({url:this.$url[105],data:{string:t.dealer}}).then((function(e){0==e.code&&(o.uname=e.data.name,console.log(e))})),this.dealer=t.dealer;var i=this.common.base64_decode(t.dealer),s="";if(2===i.split("-").length)i.split("-")[1],s=i.split("-")[0];else{i.split("-")[i.split("-").length-1];for(var r=0;r<i.split("-").length-1;r++)r===i.split("-").length-2?s+=i.split("-")[r]:s=s+i.split("-")[r]+"-"}this.uname=s}var c=this;e.login({success:function(e){c.code=e.code}}),this.loginType="小程序端",(0,a.verifyLogin)({dealer:this.dealer,invite_id:this.$store.state.username,store_id:this.store_id}).then((function(e){0==e.code?o.getCoupon(e,"islogin"):o.weixin=!0}))},onShow:function(){var t=this;e.getSystemInfo({success:function(e){"ios"==e.platform?t.$axios({url:t.$url[103]}).then((function(e){t.isios=e.data})):t.isios=!0}})},methods:{getRemainingString:function(e,t){return e.startsWith(t)?e.slice(t.length):""},clickEvent:function(t){"用户协议"==t?e.navigateTo({url:"/packgeB/UserAgreement/UserAgreement?name=用户协议"}):e.navigateTo({url:"/packgeB/UserAgreement/UserAgreement?name=隐私政策"})},checkboxChange:function(e){this.isAgreement=e.value},remind:function(){this.buttons&&(this.isAgreement=!0,this.login())},getLogin:function(){this.isAgreement?this.show=!0:e.showToast({title:"未同意《用户服务协议及隐私政策》",icon:"none"})},getLogin2:function(){e.showToast({title:"未同意《用户服务协议及隐私政策》",icon:"none"})},phoneLogin:function(t){var o=this;if(this.isAgreement){var n={code:this.code,iv:t.detail.iv,encryptedData:t.detail.encryptedData,dealer:this.dealer,invite_id:this.$store.state.username,store_id:this.store_id},i=this;e.login({success:function(e){i.code=e.code,console.log(e)}}),this.$axios({url:this.$url[125],data:n}).then((function(t){0==t.code&&(e.setStorageSync("openId",t.data.openId),e.setStorageSync("token",t.data.session),o.getCoupon(t),o.$axios({url:o.$url[47],data:{abbreviation:e.getStorageSync("abbreviation")}}).then((function(t){0==t.code&&""===e.getStorageSync("abbreviation")&&e.setStorageSync("abbreviation",t.data.data[0].abbreviation)})))}))}else{e.showToast({title:"未同意《用户服务协议及隐私政策》",icon:"none"});var a=this;e.login({success:function(e){a.code=e.code}})}},loginroute:function(t){var o=this.$store.state,n=o.peopletype,i=o.username,a=o.page,s=o.code,r=o.coupon,c=o.decrypt;a?e.navigateTo({url:"/packgeA/case/caseDetails/caseDetails?id="+a}):n?s?(e.setStorage({key:"ThousandAwn_share",data:n}),e.setStorage({key:"ThousandAwn_share_code",data:s}),e.navigateTo({url:"/packgeA/curriculumDetails/curriculumDetails?id=".concat(n,"&code=").concat(s)})):e.navigateTo({url:"/packgeA/curriculumDetails/curriculumDetails?id="+n}):i?0==t.data.isBindInvite?e.navigateTo({url:"/packgeB/timetable/aiGrowUpPlan"}):(this.$store.commit("changeusername",""),e.showToast({title:"已和该用户绑定关系",icon:"none"}),setTimeout((function(){e.reLaunch({url:"/pages/my/my"})}),1e3)):r&&c?e.reLaunch({url:"/pagesShop/coupon/coupon"}):0!=this.commodityId?e.reLaunch({url:"/pagesShop/commodity/detail?id="+this.commodityId}):0!=this.order_id?e.reLaunch({url:"/pagesShop/order/order?order_id="+this.order_id}):0!=this.activity_id?e.reLaunch({url:"/packgeB/activityDetail/activityDetail?id="+this.activity_id+"&user=true"}):e.reLaunch({url:"/pages/my/my"})},getCoupon:function(t,o){var n=this;this.coupon&&this.decrypt?(0,s.receive)({coupon:this.coupon,decrypt:this.decrypt}).then((function(i){var a=n;setTimeout((function(){a.loginStatus(t,o)}),2e3),e.showToast({title:0==i.code?i.data.name+"领取成功":i.msg,duration:2e3,icon:"none"})})):this.loginStatus(t,o)},loginStatus:function(t,o){if(e.removeStorage({key:"ThousandAwn_share"}),e.removeStorage({key:"ThousandAwn_share_code"}),"islogin"==o)this.loginroute(t);else{var n=this.$store.state,i=n.peopletype,a=n.username,s=n.page,r=n.code,c=n.coupon,u=n.decrypt;t.data.phone?t.data.nick?this.loginroute(t):e.showModal({title:"提示",content:"请完善个人信息",showCancel:!1,success:function(t){e.reLaunch({url:"/packgeA/personalData/personalData"})}}):(i?r?(e.setStorage({key:"ThousandAwn_share",data:i}),e.setStorage({key:"ThousandAwn_share_code",data:r})):e.setStorage({key:"ThousandAwn_share",data:i}):a?e.setStorage({key:"username",data:a}):s?e.setStorage({key:"page",data:s}):c&&u&&(e.setStorage({key:"coupon",data:c}),e.setStorage({key:"decrypt",data:u})),e.reLaunch({url:"/packgeA/phoneCode/phoneCode?title=绑定手机号"}))}},oauthLogin:function(){var t=this;this.isAgreement?this.common.oauthLogin().then((function(o){t.$axios({url:t.$url[3],data:c(c({},o),{},{loginType:t.loginType,dealer:t.dealer,invite_id:t.$store.state.username,store_id:t.store_id})}).then((function(o){0==o.code&&(e.setStorageSync("openId",o.data.openId),e.setStorageSync("token",o.data.session),t.getCoupon(o),t.$axios({url:t.$url[47],data:{abbreviation:e.getStorageSync("abbreviation")}}).then((function(t){0==t.code&&""===e.getStorageSync("abbreviation")&&e.setStorageSync("abbreviation",t.data.data[0].abbreviation)})))}))})).catch((function(t){t.msg&&e.showToast({icon:"none",title:t.msg,position:"bottom"})})):e.showToast({title:"未同意《用户服务协议及隐私政策》",icon:"none"})},thirdPartyLogin:function(){var t=this;this.isAgreement?this.common.oauthLogin().then((function(o){t.$axios({url:t.$url[106],data:c(c({},o),{},{loginType:t.loginType,dealer:t.dealer,invite_id:t.$store.state.username,store_id:t.store_id})}).then((function(o){console.log(o),0==o.code&&(e.setStorageSync("openId",o.data.openId),e.setStorageSync("token",o.data.session),t.getCoupon(o),t.$axios({url:t.$url[47],data:{abbreviation:e.getStorageSync("abbreviation")}}).then((function(t){0==t.code&&""===e.getStorageSync("abbreviation")&&e.setStorageSync("abbreviation",t.data.data[0].abbreviation)})))}))})).catch((function(t){console.log(t),t.msg&&e.showToast({icon:"none",title:t.msg,position:"bottom"})})):e.showToast({title:"未同意《用户服务协议及隐私政策》",icon:"none"})},login:function(){var t=this;if(this.isAgreement)if(this.isAgreement){var o={};if(this.isCode){var n=this.form;if(!n.userName)return void e.showToast({title:"请输入用户名",icon:"none"});if(!n.password)return void e.showToast({title:"请输入密码",icon:"none"});o=c(c({type:0},n),{},{loginType:this.loginType,dealer:this.dealer,invite_id:this.$store.state.username,store_id:this.store_id})}else{var i=this.phoneForm;if(!i.phone)return void e.showToast({title:"请输入手机号码",icon:"none"});if(!i.code)return void e.showToast({title:"请输入验证码",icon:"none"});o=c({type:1,dealer:this.dealer,invite_id:this.$store.state.username,store_id:this.store_id},i)}if(this.weixin)return e.setStorageSync("data",JSON.stringify(o)),void this.common.oauthLogin().then((function(e){t.submit(c(c({},o),e))})).catch((function(t){t.msg&&e.showToast({icon:"none",title:t.msg,position:"bottom"})}));this.submit(o)}else this.buttons=!this.buttons;else e.showToast({title:"未同意《用户协议》和 《隐私政策》",icon:"none"})},submit:function(t){var o=this;e.showLoading({title:"登录中"}),this.$axios({url:this.$url[0],data:t}).then((function(t){0==t.code&&(e.hideLoading(),t.data.openId&&e.setStorageSync("openId",t.data.openId),e.removeStorageSync("data"),e.setStorageSync("token",t.data.session),o.getCoupon(t),o.$axios({url:o.$url[47],data:{abbreviation:e.getStorageSync("abbreviation")}}).then((function(t){console.log(t),0==t.code&&""===e.getStorageSync("abbreviation")&&e.setStorageSync("abbreviation",t.data.data[0].abbreviation)})))}))},isPhone:function(){return/^[1][2,3,4,5,6,7,8,9][0-9]{9}$/.test(this.phoneForm.phone)},getCode:function(){var t=this;this.isPhone()?this.$refs.uCode.canGetCode?(e.showLoading({title:"正在获取验证码"}),this.$axios({url:this.$url[2],data:{phone:this.phoneForm.phone}}).then((function(o){0==o.code&&(e.hideLoading(),t.$u.toast("验证码已发送"),t.$refs.uCode.start())}))):this.$u.toast("倒计时结束后再发送"):e.showToast({title:"请输入正确的手机号码",icon:"none"})},codeChange:function(e){this.tips=e},navigateTo:function(t){e.navigateTo({url:t})}}};t.default=u}).call(this,o("df3c")["default"])},"92de":function(e,t,o){"use strict";o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var n={uForm:function(){return o.e("uview-ui/components/u-form/u-form").then(o.bind(null,"22d7"))},uFormItem:function(){return Promise.all([o.e("common/vendor"),o.e("uview-ui/components/u-form-item/u-form-item")]).then(o.bind(null,"7acd"))},uInput:function(){return Promise.all([o.e("common/vendor"),o.e("uview-ui/components/u-input/u-input")]).then(o.bind(null,"7c31"))},uToast:function(){return o.e("uview-ui/components/u-toast/u-toast").then(o.bind(null,"55b0"))},uVerificationCode:function(){return o.e("uview-ui/components/u-verification-code/u-verification-code").then(o.bind(null,"3209"))},uDivider:function(){return o.e("uview-ui/components/u-divider/u-divider").then(o.bind(null,"b1df"))},uCheckboxGroup:function(){return Promise.all([o.e("common/vendor"),o.e("uview-ui/components/u-checkbox-group/u-checkbox-group")]).then(o.bind(null,"c8d1"))},uCheckbox:function(){return o.e("uview-ui/components/u-checkbox/u-checkbox").then(o.bind(null,"dc8f"))},uPopup:function(){return o.e("uview-ui/components/u-popup/u-popup").then(o.bind(null,"aa1b"))}},i=function(){var e=this,t=e.$createElement,o=(e._self._c,e.common.imgUrl("/club/uploads/20240321/171101470565fc03312c02d.png")),n=e.common.imgUrl("/static/setUp/mountain.png");e._isMounted||(e.e0=function(){e.isCode=!e.isCode},e.e1=function(t){e.isAgreement=!e.isAgreement},e.e2=function(t){e.isAgreement=!e.isAgreement}),e.$mp.data=Object.assign({},{$root:{g0:o,g1:n}})},a=[]},9393:function(e,t,o){"use strict";(function(e,t){var n=o("47a9");o("6103");n(o("3240"));var i=n(o("ad95"));e.__webpack_require_UNI_MP_PLUGIN__=o,t(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},ad95:function(e,t,o){"use strict";o.r(t);var n=o("92de"),i=o("fc5a");for(var a in i)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("617c"),o("bf56");var s=o("828b"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"63f6e477",null,!1,n["a"],void 0);t["default"]=r.exports},bf56:function(e,t,o){"use strict";var n=o("eac6"),i=o.n(n);i.a},eac6:function(e,t,o){},fc5a:function(e,t,o){"use strict";o.r(t);var n=o("6f59"),i=o.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a}},[["9393","common/runtime","common/vendor"]]]);