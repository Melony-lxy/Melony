require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packgeA/case/tanning/tanning"],{"2e33":function(t,e,i){},"3bd4":function(t,e,i){"use strict";(function(t){var o=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("7ca3"));function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,o)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){(0,n.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var c={components:{popus:function(){i.e("packgeA/components/popus/popus").then(function(){return resolve(i("0af92"))}.bind(null,i)).catch(i.oe)},course:function(){i.e("packgeA/components/popus/course").then(function(){return resolve(i("c16e"))}.bind(null,i)).catch(i.oe)},dragSort:function(){i.e("packgeA/components/drag-sort/index").then(function(){return resolve(i("de1d"))}.bind(null,i)).catch(i.oe)}},data:function(){var t;return t={buttons:!1,is_anonymous:0,formData:{name:"file"},nodes:[{name:"div",attrs:{class:"div-class",style:"line-height: 60px; color: red; text-align:center;"},children:[{type:"text",text:"Hello&nbsp;uni-app!"}]}],message:"拍摄/上传视频",customStyle:{background:"#042BE3"},fileList:[],imagesUrlPath:"",imageList:[],src:"",checkedValue:!0,checkedIndex:0,index:0,imageValue:[],taskMenu:["动态","文章","短视频"],form:{title:"",instructions:"",label:[],video:"",file:[],money:"",label_id:[],cid:0,course:""}},(0,n.default)(t,"src",""),(0,n.default)(t,"type",0),(0,n.default)(t,"dragSortList",[{image:"",content:"",img:""}]),(0,n.default)(t,"props",{label:"label"}),(0,n.default)(t,"image",[]),(0,n.default)(t,"src",""),(0,n.default)(t,"editId",0),(0,n.default)(t,"url",this.$base_url+this.$url[19]),(0,n.default)(t,"urloption",""),(0,n.default)(t,"tempFilePaths",[]),(0,n.default)(t,"tempFilePath",[]),(0,n.default)(t,"imgList",[]),t},onLoad:function(e){this.urloption=e,this.editId=e.editId,e.type&&(this.type=parseInt(e.type)),e.editId&&(this.getCaseDetail(e.editId),t.setNavigationBarTitle({title:"编辑动态"}))},onBackPress:function(e){if("backbutton"==e.from)return t.showModal({title:"提示",content:"离开本页面将不会保存您输入的任何数据",success:function(e){e.confirm&&t.navigateBack({delta:1})}}),!0},methods:{uploads:function(e){var i=this;t.showLoading({title:"正在上传第".concat(e+1,"张图片"),mask:!0}),this.$axios({url:this.$url[112],data:{extension:this.tempFilePath[e].split(".")[this.tempFilePath[e].split(".").length-1]}}).then((function(o){var n=i;0==o.code&&t.uploadFile({url:o.data.host,filePath:n.tempFilePath[e],name:"file",formData:{key:o.data.key,policy:o.data.policy,OSSAccessKeyId:o.data.OSSAccessKeyId,signature:o.data.signature},success:function(i){console.log(i),204===i.statusCode?(n.tempFilePath.length-1!=e&&(e++,n.uploads(e)),t.hideLoading(),n.image.push("/"+o.data.key),n.dragSortList[n.index].image="/"+o.data.key,n.dragSortList[n.index].img="/"+o.data.key,n.index++,n.index<9&&n.dragSortList.push({image:"",content:"",img:""})):(n.tempFilePath.length-1!=e&&(e++,n.upload(e)),t.hideLoading())},fail:function(t){console.log(t)}})}))},upload:function(e){var i=this;this.$axios({url:this.$url[112],data:{extension:this.tempFilePaths[e].split(".")[this.tempFilePaths[e].split(".").length-1]}}).then((function(o){var n=i;0==o.code&&(console.log({url:o.data.host,filePath:n.tempFilePaths[e].path,name:"file",formData:{key:o.data.key,policy:o.data.policy,OSSAccessKeyId:o.data.OSSAccessKeyId,signature:o.data.signature}}),t.uploadFile({url:o.data.host,filePath:n.tempFilePaths[e].path,name:"file",formData:{key:o.data.key,policy:o.data.policy,OSSAccessKeyId:o.data.OSSAccessKeyId,signature:o.data.signature},success:function(i){console.log(i),204===i.statusCode?(n.tempFilePaths.length-1!=e&&(e++,n.upload(e)),t.hideLoading(),console.log(o.data.key),n.imgList.push("/"+o.data.key),console.log("上传成功")):(n.tempFilePaths.length-1!=e&&(e++,n.upload(e)),t.hideLoading())},fail:function(t){console.log(t)}}))}))},ossImage:function(){var e=9-this.imgList.length,i=this;t.chooseImage({count:e,sizeType:["compressed"],success:function(t){i.tempFilePaths=t.tempFilePaths,i.upload(0)}})},checkboxChange:function(t){t.value?this.is_anonymous=1:this.is_anonymous=0},onEditorReady:function(){var e=this;t.createSelectorQuery().select("#editor").context((function(t){e.editorCtx=t.context})).exec()},remove:function(t){this.fileList.splice(t,1),this.form.file.splice(t,1)},chooseVideo:function(){this.imgList.length>0&&(this.imgList=[]);var e=this;t.chooseVideo({maxDuration:60,sourceType:["camera","album"],success:function(i){i.size>209715200?t.showToast({title:"上传大小超过最大值",icon:"none"}):(t.showLoading({title:"上传中"}),e.message="上传中",e.$axios({url:e.$url[112],data:{extension:i.tempFilePath.split(".")[i.tempFilePath.split(".").length-1]}}).then((function(o){0==o.code&&t.uploadFile({url:o.data.host,filePath:i.tempFilePath,name:"file",formData:{key:o.data.key,policy:o.data.policy,OSSAccessKeyId:o.data.OSSAccessKeyId,signature:o.data.signature},success:function(i){204===i.statusCode?(t.hideLoading(),e.message="重新上传",e.form.video="/"+o.data.key):t.showToast({title:"上传失败",icon:"none"})},fail:function(t){console.log(t)}})})))}})},deleteImg:function(t){this.imgList.splice(t,1)},primary:function(){var e=this,i=this.urloption.circleId,o=this.urloption.topicId,n={};if(0==this.type||1==this.type){if(0==this.imgList.length)return void t.showToast({title:"请上传图片",icon:"none"})}else this.imgList=[];for(var a=[],s=0;s<this.dragSortList.length;s++)(this.dragSortList[s].img||this.dragSortList[s].content)&&a.push({img:this.dragSortList[s].img,content:this.dragSortList[s].content});0!=this.type&&2!=this.type||(a=[]);var c=[];this.imgList.forEach((function(t){c.push(t)})),void 0==i&&void 0==o?n={url:this.$url[58],data:{id:this.editId,type:this.type,title:this.form.title,cid:this.form.cid,instructions:this.form.instructions,label_id:this.form.label_id,content:a,file:c,video:this.form.video,is_anonymous:this.is_anonymous}}:void 0!=i&&void 0==o?n={url:this.$url[58],data:{id:this.editId,type:this.type,title:this.form.title,cid:this.form.cid,instructions:this.form.instructions,label_id:this.form.label_id,content:a,file:c,exchange_id:i,video:this.form.video,is_anonymous:this.is_anonymous}}:void 0==i&&void 0!=o&&(n={url:this.$url[58],data:{id:this.editId,type:this.type,title:this.form.title,cid:this.form.cid,instructions:this.form.instructions,label_id:this.form.label_id,content:a,file:c,special_id:o,video:this.form.video,is_anonymous:this.is_anonymous}}),this.$axios(n).then((function(i){if(0==i.code){t.showModal({title:"提示",content:e.editId?"编辑成功":"发布成功",cancelText:"返回",success:function(e){e.confirm?(console.log(e),t.switchTab({url:"/pages/case/case"}),t.setStorageSync("is_shile",!0)):e.cancel&&t.switchTab({url:"/pages/case/case"})}})}}))},getCaseDetail:function(t){var e=this;this.$axios({url:this.$url[49],data:{id:t}}).then((function(t){if(0==t.code){var i=t.data;e.type=i.type,i.file.forEach((function(t){e.fileList.push({url:e.common.imgUrl(t)})})),i.content&&(e.dragSortList=[],i.content.forEach((function(t){console.log(t),e.dragSortList.push(s(s({},t),{},{image:e.common.imgUrl(t.img)}))}))),e.form.title=i.title,e.form.instructions=i.instructions,e.form.cid=i.cid,e.form.course=i.course.name,e.form.label_id=i.label_id,e.form.file=i.file,console.log(e.form.file,"file"),e.form.video=i.video_url,console.log(i,e.form,"res"),i.label.forEach((function(t){e.form.label.push(s(s({},t),{},{type:!0}))}))}}))},uploadSuccess:function(e){0==e.code?this.form.file.push(e.data):t.showModal({title:"上传图片失败",content:e.msg,showCancel:!1,confirmText:"确定"})},chooseImage:function(){var e=9-this.image.length;console.log(e);var i=this;t.chooseImage({count:e,sizeType:["compressed"],success:function(t){console.log(t),i.tempFilePath=t.tempFilePaths,i.uploads(0)}})},previewImage:function(e){var i=e.target.dataset.src;t.previewImage({current:i,urls:this.imageList})},delect:function(e){var i=this;t.showModal({title:"提示",content:"是否要删除该图片",success:function(t){t.confirm&&i.imageList.splice(e,1)}})},select:function(t){console.log("选择文件：",t)},Remove:function(t){this.index--,this.dragSortList.splice(t,1),this.image.splice(t,1)},contentInput:function(t){this.dragSortList[t.index].content=t.content},changeMenu:function(t){this.type=t},bindPickerChange:function(t){this.index=t.target.value},getCard:function(t){var e=this;console.log(t,"resss"),0!=t.length&&(this.form.label=t,this.form.label_id=[],this.form.label.forEach((function(t){e.form.label_id.push(t.id)})))},getCourse:function(t){this.form.cid=t.id,this.form.course=t.name},deletes:function(t){this.form.label.splice(t,1),this.form.label_id.splice(t,1),console.log(this.form.label,this.form.label_id)},getDraft:function(){var e=this;t.getStorage({key:"draft"+e.type,success:function(t){var i=this;e.title=t.data.title,e.caseText=t.data.caseText,e.labelActive=t.data.labelActive,e.imageList=t.data.imageList,e.index=t.data.imageList.length-1,e.imageList.forEach((function(t,o){t.img&&(e.imageList[o].image=i.$request.img_url+t.img,e.image.push(e.imageList[o].image))}))}})},onDragSortChange:function(t){var e=[],i=[],o=[];this.dragSortList.forEach((function(n,a){n.img==t.data.img?i=n:(e.push(n),n.image&&o.push(n.image))})),t.frontData?this.dragSortList.forEach((function(n,a){n.img==t.frontData.img&&(e.splice(a+1,0,i),i.image&&o.splice(a+1,0,i.image))})):(e.unshift(i),i.image&&o.unshift(i.image)),this.image=o,this.dragSortList=e}}};e.default=c}).call(this,i("df3c")["default"])},"3d0a1":function(t,e,i){"use strict";var o=i("2e33"),n=i.n(o);n.a},"3d2a":function(t,e,i){"use strict";i.r(e);var o=i("3bd4"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},"4ed4":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var o={uButton:function(){return i.e("uview-ui/components/u-button/u-button").then(i.bind(null,"7d22"))},uIcon:function(){return i.e("uview-ui/components/u-icon/u-icon").then(i.bind(null,"203b"))},uImage:function(){return i.e("uview-ui/components/u-image/u-image").then(i.bind(null,"31fd"))}},n=function(){var t=this,e=t.$createElement,i=(t._self._c,2==t.type&&t.form.video?t.common.imgUrl(t.form.video):null),o=2==t.type?t.form.file.length:null,n=2!==t.type?t.__map(t.imgList,(function(e,i){var o=t.__get_orig(e),n=t.common.imgUrl(e),a=t.common.imgUrl("/static/dynamic/add.png");return{$orig:o,g2:n,g3:a}})):null,a=2!==t.type?t.imgList.length:null,s=2!==t.type&&9!==a?t.common.imgUrl("/static/add.png"):null,c=2!==t.type?t.__map(2-t.imgList.length%3,(function(e,i){var o=t.__get_orig(e),n=t.imgList.length;return{$orig:o,g6:n}})):null,l=t.__map(t.form.label,(function(e,i){var o=t.__get_orig(e),n=e.name?t.common.imgUrl("/static/case/closes.png"):null;return{$orig:o,g7:n}}));t.$mp.data=Object.assign({},{$root:{g0:i,g1:o,l0:n,g4:a,g5:s,l1:c,l2:l}})},a=[]},"81de":function(t,e,i){"use strict";(function(t,e){var o=i("47a9");i("6103");o(i("3240"));var n=o(i("9ef5"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(n.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},"9ef5":function(t,e,i){"use strict";i.r(e);var o=i("4ed4"),n=i("3d2a");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("3d0a1");var s=i("828b"),c=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"c97cb724",null,!1,o["a"],void 0);e["default"]=c.exports}},[["81de","common/runtime","common/vendor"]]]);