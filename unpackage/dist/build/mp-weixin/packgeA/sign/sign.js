require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packgeA/sign/sign"],{"1ab9":function(t,e,i){"use strict";(function(t){var n=i("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("94b6")),s=(i("babc"),{components:{signTab:function(){i.e("packgeA/components/signTabbar").then(function(){return resolve(i("60c3"))}.bind(null,i)).catch(i.oe)}},data:function(){return{qqMap:new a.default({key:"B4UBZ-E63CQ-7X35P-GZBDW-V76FT-JABBC",vm:this}),recordPopup:!1,params:{year:!0,month:!0,day:!0,hour:!1,minute:!1,second:!1},recordList:[],date:"",time:"",startTimeShow:!1,timer:null,user:{nick:"",org:"",avater_url:""},day:{id:0,order_id:0,name:"",time:"",status:0,signTime:""},now:"",address:"",latitude:"",longitude:""}},onLoad:function(){var e=this;this.date=(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+((new Date).getDate()<10?"0"+(new Date).getDate():(new Date).getDate()),console.log(this.date),this.now=this.date,this.getClassDayList();var i=t.getStorageSync("peoplenumber");0==i?this.$axios({url:this.$url[6]}).then((function(t){0==t.code&&(e.user=t.data,e.user.avater_url=t.data.avatar_url)})):this.$axios({url:this.$url[88],data:{member_id:i}}).then((function(t){0==t.code&&(e.user=t.data,e.user.avater_url=t.data.avatar_url)})),this.timer=setInterval((function(){e.getNowTime()})),this.wxConfig()},onUnload:function(){clearInterval(this.timer)},methods:{wxConfig:function(){var e=this;t.getLocation({success:function(t){e.latitude=t.latitude,e.longitude=t.longitude,e.qqMap.reverseGeocoder({location:{latitude:t.latitude,longitude:t.longitude},success:function(t){console.log(t),e.address=t.result.address},fail:function(t){console.log(t)}})},fail:function(){t.showToast({icon:"none",title:"请允许获取您的地理位置，否则部分功能不能使用",duration:2e3})}})},goGeturl:function(e){console.log(e,"dajksdlajsoij"),t.navigateTo({url:"/packgeB/liveDetails/liveDetails?id="+e})},timeShow:function(){this.startTimeShow=!0},timeConfirm:function(t){this.date=t.year+"-"+t.month+"-"+t.day,this.getClassDayList()},changeDay:function(t,e){var i=[];this.day={id:t.id,order_id:t.order_id,name:t.course_name+"-"+t.name,time:t.start_time.split(" ")[1]+"-"+t.end_time,status:t.signInstatus,signTime:t.signTime?t.signTime.split(" ")[1]:""},"null"!=e&&(i=this.recordList[e],this.recordList[e]=this.recordList[0],this.recordList[0]=i,this.recordPopup=!1)},getClassDayList:function(){var e=this;this.common.loading();var i=t.getStorageSync("peoplenumber");this.$axios({url:this.$url[28],data:{query:{time:this.date,member_id:i}}}).then((function(n){var a=!1;if(n.data.data.length>0){var s=n.data.data[0];e.day={id:s.id,order_id:s.order_id,name:s.course_name+"-"+s.name,time:s.start_time.split(" ")[1]+"-"+s.end_time,status:s.signInstatus,signTime:s.signTime?s.signTime:""}}else e.$axios({url:e.$url[61],data:{date:e.date,member_id:i}}).then((function(t){e.day={id:0,order_id:0,name:"",time:"",status:t.time?0:new Date(e.now)==new Date(e.date)?2:1,signTime:t.time?t.time:""}}));n.data.data.forEach((function(t){t.name=t.course_name+"-"+t.name,t.status=t.signInstatus,t.time="上课"+t.start_time.split(" ")[1],!a&&t.signInstatus>0&&(e.day={id:t.id,order_id:t.order_id,name:t.course_name+"-"+t.name,time:t.start_time.split(" ")[1]+"-"+t.end_time,status:t.signInstatus,signTime:""},a=!0)})),e.recordList=n.data.data,t.hideLoading()}))},toClass:function(){t.switchTab({url:"/pages/timetable/timetable"})},showRecord:function(){this.recordPopup=!0},sign:function(){if(this.day.id>0||1!=this.day.status){if(0===this.day.id&&this.recordList.length>0)return void this.$u.toast("请选择课程");if(0===this.day.status)return void this.$u.toast("已签到，请勿重复签到");if(new Date(this.now)<new Date(this.date))return void this.$u.toast("未到签到时间");var e=t.getStorageSync("peoplenumber"),i=this;t.showModal({title:"提示",content:"确认签到吗?",success:function(n){n.confirm&&(i.common.loading(),i.$axios({url:i.$url[60],data:{member_id:e,date:i.date,day_id:i.day.id,address:i.address,latitude:i.latitude,longitude:i.longitude}}).then((function(e){i.getClassDayList(),t.vibrateLong(),t.hideLoading()})))}})}},getNowTime:function(){var t,e=(new Date).getHours(),i=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes(),n=(new Date).getSeconds()<10?"0"+(new Date).getSeconds():(new Date).getSeconds();t=e+":"+i+":"+n,this.time=t}}});e.default=s}).call(this,i("df3c")["default"])},8825:function(t,e,i){"use strict";i.r(e);var n=i("db6a"),a=i("d1ff");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("f498");var o=i("828b"),r=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"7ecb13b8",null,!1,n["a"],void 0);e["default"]=r.exports},c301:function(t,e,i){},d1ff:function(t,e,i){"use strict";i.r(e);var n=i("1ab9"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},db6a:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={uIcon:function(){return i.e("uview-ui/components/u-icon/u-icon").then(i.bind(null,"203b"))},uPopup:function(){return i.e("uview-ui/components/u-popup/u-popup").then(i.bind(null,"aa1b"))},uPicker:function(){return Promise.all([i.e("common/vendor"),i.e("uview-ui/components/u-picker/u-picker")]).then(i.bind(null,"4171"))}},a=function(){var t=this.$createElement,e=(this._self._c,this.common.imgUrl("/static/images/round.png")),i=this.common.imgUrl(this.user.avater_url),n=this.recordList.length;this.$mp.data=Object.assign({},{$root:{g0:e,g1:i,g2:n}})},s=[]},f3e8:function(t,e,i){"use strict";(function(t,e){var n=i("47a9");i("6103");n(i("3240"));var a=n(i("8825"));t.__webpack_require_UNI_MP_PLUGIN__=i,e(a.default)}).call(this,i("3223")["default"],i("df3c")["createPage"])},f498:function(t,e,i){"use strict";var n=i("c301"),a=i.n(n);a.a}},[["f3e8","common/runtime","common/vendor","packgeA/common/vendor"]]]);